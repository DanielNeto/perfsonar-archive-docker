output {
  if [test][type] {
    elasticsearch {
      hosts => ["${OUTPUT_HOST}"] # e.g., "https://elasticsearch.example.com:9200"
      user => "${OUTPUT_USER}"     # Should be "pscheduler_logstash"
      password => "${OUTPUT_PASSWORD}" # Password for pscheduler_logstash

      # SSL/TLS Configuration:
      # ssl_enabled defaults to true if hosts starts with https. Explicitly set if needed.
      # ssl => true
      ssl_certificate_verification => "${OUTPUT_SSL_CERTIFICATE_VERIFICATION:-true}" # Default to true. Set env var to "false" to disable.
      # If using a custom CA and ssl_certificate_verification is true:
      # cacert => "${OUTPUT_CACERT_PATH}" # Mount your ca.crt and provide the path

      # Data Stream Configuration:
      data_stream => "true"
      data_stream_type => "${OUTPUT_DATA_STREAM_TYPE:-metrics}" # 'metrics' or 'logs'. 'metrics' is good for perfSONAR.
      data_stream_dataset => "pscheduler"
      data_stream_namespace => "%{[test][type]}" # Dynamic part, e.g., "throughput", "latency"
      action => "create" # This is the correct action for data streams.

      # The resulting data stream name will be like:
      # <data_stream_type>-<data_stream_dataset>-<data_stream_namespace>
      # e.g., metrics-pscheduler-throughput
    }
  }
}